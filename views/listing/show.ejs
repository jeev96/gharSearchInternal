<%- include ("../partials/header") %>

<main>
    <div class="px-3">
        <div class="theme-container">
            <div class="page-drawer-container single-property mt-3">
                <div class="page-sidenav-content">
                    <div class="mdc-card row between-xs middle-xs p-3">
                        <div>
                            <h2 class="uppercase mr-1"><%= listing.location.project %></h2>
                            <p class="row flex-nowrap address mb-0">
                                <i class="material-icons text-muted">location_on</i>
                                <span class="fw-500 text-muted">Sector
                                    <%= listing.location.sector + ", " + listing.location.city %></span>
                            </p>
                        </div>
                        <div class="column">
                            <h2 class="primary-color price">
                                <span><%= new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0,  maximumFractionDigits: 0 }).format(parseInt(listing.price)) %></span>
                            </h2>
                            <div class="row end-xs middle-xs ratings" title="29">
                                <i class="material-icons mat-icon-sm">star</i>
                                <i class="material-icons mat-icon-sm">star</i>
                                <i class="material-icons mat-icon-sm">star</i>
                                <i class="material-icons mat-icon-sm">star</i>
                                <i class="material-icons mat-icon-sm">star_half</i>
                            </div>
                        </div>
                        <button id="page-sidenav-toggle"
                            class="mdc-icon-button material-icons text-muted d-md-none d-lg-none d-xl-none">
                            more_vert
                        </button>
                    </div>
                    <div class="mdc-card p-3 mt-3">
                        <div class="main-carousel mb-3">
                            <div class="control-icons">
                                <button class="mdc-button add-to-favorite" data-value="<%= listing._id %>"
                                    title="Add To Favorite">
                                    <i class="material-icons">favorite_border</i>
                                </button>
                                <button class="mdc-button add-to-compare" data-value="<%= listing._id %>"
                                    title="Add To Compare">
                                    <i class="material-icons">compare_arrows</i>
                                </button>
                            </div>
                            <div class="swiper-container">
                                <div class="swiper-wrapper">
                                    <% listing.media.images.forEach(function(image, index) { %>
                                    <div class="swiper-slide">
                                        <img src="/assets/images/others/transparent-bg.png" alt="slide image"
                                            data-src="/uploads/listing/<%= listing._id %>/images/large/<%= image %>"
                                            class="slide-item swiper-lazy">
                                        <div class="swiper-lazy-preloader"></div>
                                    </div>
                                    <% }); %>
                                </div>
                                <button class="swiper-button-prev swipe-arrow mdc-fab mdc-fab--mini primary">
                                    <span class="mdc-fab__ripple"></span>
                                    <span class="mdc-fab__icon material-icons">keyboard_arrow_left</span>
                                </button>
                                <button class="swiper-button-next swipe-arrow mdc-fab mdc-fab--mini primary">
                                    <span class="mdc-fab__ripple"></span>
                                    <span class="mdc-fab__icon material-icons">keyboard_arrow_right</span>
                                </button>
                            </div>
                        </div>

                        <div class="small-carousel">
                            <div id="small-carousel" class="swiper-container">
                                <div class="swiper-wrapper">
                                    <% listing.media.images.forEach(function(image, index) { %>
                                    <div class="swiper-slide">
                                        <img src="/assets/images/others/transparent-bg.png" alt="slide image"
                                            data-src="/uploads/listing/<%= listing._id %>/images/small/<%= image %>"
                                            class="slide-item swiper-lazy">
                                        <div class="swiper-lazy-preloader"></div>
                                    </div>
                                    <% }); %>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mdc-card p-3 mt-3">
                        <h2 class="uppercase text-center fw-500 mb-2">Details</h2>
                        <div class="row details">
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Property Type:</span>
                                <span><%= listing.propertyType.type %></span>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Subtype:</span>
                                <span><%= listing.propertyType.subtype %></span>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Property Status:</span>
                                <div class="row list">
                                    <% for(let i= 0; i < listing.listingInfo.tags.length -1; i++) { %>
                                    <span><%= listing.listingInfo.tags[i] %></span>
                                    <% } %>
                                    <span
                                        class="last"><%= listing.listingInfo.tags[listing.listingInfo.tags.length -1] %>
                                    </span>
                                </div>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Neighborhood:</span>
                                <div class="row list">
                                    <span><%= listing.location.project %></span>
                                    <span class="last"><%= listing.location.sector %></span>
                                </div>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>City:</span>
                                <span><%= listing.location.city %></span>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Bedrooms:</span>
                                <span><%= listing.propertyInfo.bedrooms %></span>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Bathrooms:</span>
                                <span><%= listing.propertyInfo.bathrooms %></span>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Garages:</span>
                                <span><%= listing.propertyInfo.reservedParking %></span>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Property size:</span>
                                <span><%= listing.propertyInfo.area %> ft²</span>
                            </div>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span>Year Built:</span>
                                <span><%= listing.propertyInfo.builtYear %></span>
                            </div>
                        </div>
                    </div>
                    <div class="mdc-card p-3 mt-3">
                        <h2 class="uppercase text-center fw-500 mb-2">Features</h2>
                        <div class="row">
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("Air Conditioning") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">Air Conditioning</span>
                            </div>
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("Barbeque") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">Barbeque</span>
                            </div>
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("Dryer") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">Dryer</span>
                            </div>
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("Microwave") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">Microwave</span>
                            </div>
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("Refrigerator") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">Refrigerator</span>
                            </div>
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("Fireplace") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">Fireplace</span>
                            </div>
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("Swimming Pool") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">Swimming Pool</span>
                            </div>
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("TV Cable") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">TV Cable</span>
                            </div>
                            <div class="col-xs-12 col-sm-4 row middle-xs">
                                <i
                                    class="material-icons mat-icon-sm primary-color"><%= listing.propertyInfo.amenities.indexOf("WiFi") > -1 ? "check" : "cross" %></i>
                                <span class="mx-2">WiFi</span>
                            </div>
                        </div>
                    </div>

                    <% if (listing.propertyInfo.additionalFeatures.length > 0) { %>
                    <div class="mdc-card p-3 mt-3">
                        <h2 class="uppercase text-center fw-500 mb-2">Additional features</h2>
                        <div class="row details">
                            <% listing.propertyInfo.additionalFeatures.forEach((feature) => { %>
                            <div class="row col-xs-12 col-sm-6 item">
                                <span><%= feature.name %> :</span>
                                <span><%= feature.value %> </span>
                            </div>
                            <% }); %>
                        </div>
                    </div>
                    <% } %>

                    <div class="mdc-card p-3 mt-3">
                        <h2 class="uppercase text-center fw-500 mb-2">Description</h2>
                        <p><%= listing.listingInfo.description %></p>
                    </div>

                    <% if(listing.location.map && listing.location.map.lat) { %>
                    <input id="listing-lat" type="hidden" name="lat" value="<%= listing.location.map.lat %>">
                    <input id="listing-lon" type="hidden" name="lon" value="<%= listing.location.map.lon %>">
                    <div class="mdc-card p-3 mt-3">
                        <h2 class="uppercase text-center fw-500 mb-2">Location</h2>
                        <div id="listing-map"></div>
                    </div>
                    <% } %>

                    <% if (listing.media.plans.length > 0) { %>
                    <div class="mdc-card p-3 mt-3">
                        <h2 class="uppercase text-center fw-500 mb-2">Plans</h2>
                        <div class="expansion-panel-wrapper">
                            <% listing.media.plans.forEach(plan => { %>
                            <div class="mdc-card expansion-panel">
                                <div class="row between-xs middle-xs expansion-panel-header">
                                    <div class="fw-500"><%= plan.name %></div>
                                    <div class="text-muted d-none d-md-flex d-lg-flex d-xl-flex">
                                        <span>Area: <span class="fw-500"><%= plan.area %> ft²</span></span>
                                        <span class="mx-3">Rooms: <span class="fw-500"><%= plan.rooms %></span></span>
                                        <span>Baths: <span class="fw-500"><%= plan.baths %></span></span>
                                    </div>
                                </div>
                                <div class="expansion-panel-body text-center">
                                    <img src="/uploads/listing/<%= listing._id %>/plans/<%= plan.image %>" alt="plan-1"
                                        class="mw-100">
                                    <p><%= plan.description %></p>
                                </div>
                            </div>
                            <% }); %>
                        </div>
                    </div>
                    <% } %>

                    <% if (listing.media.videos.length > 0) { %>
                    <div class="mdc-card p-3 mt-3">
                        <h2 class="uppercase text-center fw-500 mb-2">Videos</h2>
                        <% listing.media.videos.forEach(video => { %>
                        <div class="videoWrapper my-2">
                            <iframe src=<%= video.link %>></iframe>
                        </div>
                        <% }); %>
                    </div>
                    <% } %>

                    <div class="mdc-card p-3 mt-3 row between-xs middle-xs">
                        <span>ID:<span class="fw-500 mx-2"><%= listing._id %> </span></span>
                        <span>Published:<span
                                class="fw-500 mx-2"><%= moment(listing.createdAt).format("ll") %></span></span>
                        <span>Last Update:<span class="fw-500 mx-2"><%= moment(listing.lastModified).format("ll") %>
                            </span></span>
                        <span>Views:<span class="fw-500 mx-2">322</span></span>
                    </div>

                </div>
                <aside class="mdc-drawer mdc-drawer--modal page-sidenav">
                    <div id="page-sidenav-close" title="Close" class="mdc-card d-none">
                        <div class="widget">
                            <div class="row end-xs middle-xs py-1 px-3">
                                <button id="page-sidenav-close-button"
                                    class="mdc-icon-button material-icons warn-color">close</button>
                            </div>
                        </div>
                    </div>
                    <% if(listing.listingInfo.contactDisplay.type !== "NONE") { %>
                    <div class="mdc-card p-3 my-1">
                        <div class="widget">
                            <div class="mdc-card o-hidden">
                                <a
                                    href="<%= listing.listingInfo.contactDisplay.type === "BUILDER" ? `/builder/${listing.builderId}` : "#" %>">
                                    <img src="<%= listing.listingInfo.contactDisplay.type === "BUILDER" ? `/uploads/builder/${listing.builderId}/agentImage.jpg` : `/uploads/user/${listing.author.id}/agentImage.jpg` %>"
                                        alt="agent-image" class="d-block mw-100">
                                </a>
                                <div class="p-3">
                                    <h2 class="fw-600">
                                        <%= listing.listingInfo.contactDisplay.type === "BUILDER" ? builderInfo.name : listing.contactInfo.name %>
                                    </h2>
                                    <p class="mt-3 text-muted fw-500">
                                        <%= listing.listingInfo.contactDisplay.type === "BUILDER" ? builderInfo.descriptionShort : listing.contactInfo.description %>
                                    </p>
                                    <% if(listing.listingInfo.contactDisplay.type !== "BUILDER") { %>
                                    <p class="row middle-xs"><i class="material-icons primary-color"
                                            title="Organization">business</i><span
                                            class="mx-2 text-muted fw-500"><%= listing.contactInfo.firmName %></span>
                                    </p>
                                    <% } %>
                                    <% if(listing.listingInfo.contactDisplay.email) { %>
                                    <p class="row middle-xs"><i class="material-icons primary-color">email</i>
                                        <span class="mx-2 text-muted fw-500">
                                            <%= listing.listingInfo.contactDisplay.type === "BUILDER" ? builderInfo.email : listing.contactInfo.email %>
                                        </span>
                                    </p>
                                    <% } %>
                                    <% if(listing.listingInfo.contactDisplay.phone) { %>
                                    <p class="row middle-xs"><i class="material-icons primary-color">call</i>
                                        <span class="mx-2 text-muted fw-500">
                                            <%= listing.listingInfo.contactDisplay.type === "BUILDER" ? builderInfo.phone : listing.contactInfo.phone[0] %>
                                        </span>
                                    </p>
                                    <% } %>
                                    <div class="row pb-3 p-relative">
                                        <div class="divider"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% } %>
                    <div class="mdc-card p-3 my-1">
                        <div class="widget">
                            <div class="widget-title bg-primary">Get in Touch</div>
                            <form id="leads" action="javascript:void(0);">
                                <p>Interested in renting or buying this property? Then send us an email.</p>
                                <div class="mdc-text-field mdc-text-field--outlined w-100 custom-field my-2">
                                    <input name="name" class="mdc-text-field__input" autocomplete="name">
                                    <div class="mdc-notched-outline">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">Name</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <div class="mdc-text-field mdc-text-field--outlined w-100 custom-field my-2">
                                    <input name="email" type="email" class="mdc-text-field__input" autocomplete="email">
                                    <div class="mdc-notched-outline">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">Email</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <div class="mdc-text-field mdc-text-field--outlined w-100 custom-field my-2">
                                    <input id="phone" name="phone" type="tel" placeholder="+91 9876543210"
                                        class="mdc-text-field__input" autocomplete="tel">
                                    <div class="mdc-notched-outline">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">Phone</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <div
                                    class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea w-100 custom-field my-2">
                                    <textarea name="message" class="mdc-text-field__input" rows="5"
                                        placeholder="Message is required"></textarea>
                                    <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label for="feedback-message" class="mdc-floating-label">Message</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <input type="hidden" name="listing_id" value="<%= listing._id %>">
                                <input type="hidden" name="listingName" value="<%= listing.location.project %>">
                                <div class="row around-xs middle-xs p-2 mb-3">
                                    <button class="mdc-button mdc-button--raised bg-accent" type="submit">
                                        <span class="mdc-button__ripple"></span>
                                        <span class="mdc-button__label">Submit</span>
                                    </button>
                                </div>
                                <p id="lead-success" class="primary-color d-none"></p>
                            </form>
                        </div>
                    </div>
                    <div class="mdc-card p-3 my-1">
                        <div class="widget">
                            <div class="widget-title bg-primary">Loan Calculator</div>
                            <form id="loan-calculator" action="javascript:void(0);">
                                <div class="mdc-text-field mdc-text-field--outlined w-100 custom-field my-2">
                                    <input type="number" name="principal" min="1" class="mdc-text-field__input"
                                        placeholder="₹" required>
                                    <div class="mdc-notched-outline">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">Principal Amount</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <div class="mdc-text-field mdc-text-field--outlined w-100 custom-field my-2">
                                    <input type="number" step="0.01" min="0.01" name="interest"
                                        class="mdc-text-field__input" placeholder="9.15%" required>
                                    <div class="mdc-notched-outline">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">Interest Rate</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <div class="mdc-text-field mdc-text-field--outlined w-100 custom-field my-2">
                                    <input type="number" name="term" min="1" class="mdc-text-field__input"
                                        placeholder="Number of Years" required>
                                    <div class="mdc-notched-outline">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">Period</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <div class="row around-xs middle-xs p-2 mb-3">
                                    <button class="mdc-button mdc-button--raised bg-accent" type="submit">
                                        <span class="mdc-button__ripple"></span>
                                        <span class="mdc-button__label">Calculate Mortgage</span>
                                    </button>
                                </div>
                            </form>
                            <div id="loan-details" class="d-none mdc-card property-item grid-item column-3 mb-3">
                                <div class="property-content-wrapper">
                                    <div class="property-content">
                                        <div class="content">
                                            <div class="row between-xs middle-xs">
                                                <h3 class="primary-color price">
                                                    <span id="monthly-payment">Monthly Payment</span>
                                                </h3>
                                            </div>
                                            <div class="features mt-3">
                                                <p><span>Total Payement</span><span id="total-payment"></span></p>
                                                <p><span>Total Interest Paid</span><span id="total-interest"></span></p>
                                                <p><span>Interest Ratio</span><span id="interest-ratio"></span></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% if (similarListings.length > 0) { %>
                    <div class="mdc-card p-3 my-1">
                        <div class="widget">
                            <div class="widget-title bg-primary">Similar Properties</div>

                            <% similarListings.forEach((listing) => { %>
                            <div class="mdc-card property-item grid-item column-3 mb-3">
                                <div class="thumbnail-section">
                                    <div class="row property-status">
                                        <% for(let i = 0; i < listing.listingInfo.tags.length; i++) {
                                        let tag = listing.listingInfo.tags[i]; 
                                        let color = tag === "FOR SALE" ? "green" :
                                                    tag === "FEATURED" ? "orange" :
                                                    tag === "FOR RENT" ? "blue" :
                                                    tag === "HOT OFFER" ? "red" :
                                                    tag === "SOLD" ? "dark" :
                                                    tag === "NEW" ? "teal" : ""
                                        %>
                                        <span class="<%= color %>"><%= tag %></span>
                                        <% } %>
                                    </div>
                                    <div class="property-image">
                                        <div class="swiper-container">
                                            <div class="swiper-wrapper">
                                                <% listing.media.images.forEach((image) => { %>
                                                <div class="swiper-slide">
                                                    <img src="/assets/images/others/transparent-bg.png"
                                                        alt="slide image <%= image %>"
                                                        data-src="/uploads/listing/<%= listing._id %>/images/medium/<%= image %>"
                                                        class="slide-item swiper-lazy">
                                                    <div class="swiper-lazy-preloader"></div>
                                                </div>
                                                <% }); %>
                                            </div>
                                            <div class="swiper-pagination white"></div>
                                            <button class="mdc-icon-button swiper-button-prev swipe-arrow"><i
                                                    class="material-icons mat-icon-lg">keyboard_arrow_left</i></button>
                                            <button class="mdc-icon-button swiper-button-next swipe-arrow"><i
                                                    class="material-icons mat-icon-lg">keyboard_arrow_right</i></button>
                                        </div>
                                    </div>
                                    <div class="control-icons">
                                        <button class="mdc-button add-to-favorite" data-value="<%= listing._id %>"
                                            title="Add To Favorite">
                                            <i class="material-icons mat-icon-sm">favorite_border</i>
                                        </button>
                                        <button class="mdc-button add-to-compare" data-value="<%= listing._id %>"
                                            title="Add To Compare">
                                            <i class="material-icons mat-icon-sm">compare_arrows</i>
                                        </button>
                                    </div>
                                </div>
                                <div class="property-content-wrapper">
                                    <div class="property-content">
                                        <div class="content">
                                            <h1 class="title">
                                                <a
                                                    href="/listing/<%= hyphenateString(listing.listingInfo.title) + "-"+ listing._id %>">
                                                    <%= listing.listingInfo.title %>
                                                </a>
                                            </h1>
                                            <p class="row address flex-nowrap">
                                                <i class="material-icons text-muted">location_on</i>
                                                <span><%= listing.location.sector + ", " + listing.location.city %></span>
                                            </p>
                                            <div class="row between-xs middle-xs">
                                                <h3 class="primary-color price">
                                                    <span><%= new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0,  maximumFractionDigits: 0 }).format(listing.price) %></span>
                                                </h3>
                                                <div class="row start-xs middle-xs ratings" title="29">
                                                    <i class="material-icons mat-icon-sm">star</i>
                                                    <i class="material-icons mat-icon-sm">star</i>
                                                    <i class="material-icons mat-icon-sm">star</i>
                                                    <i class="material-icons mat-icon-sm">star</i>
                                                    <i class="material-icons mat-icon-sm">star</i>
                                                </div>
                                            </div>
                                            <div class="d-none d-md-flex d-lg-flex d-xl-flex">
                                                <div class="description mt-3">
                                                    <p><%= listing.listingInfo.description %></p>
                                                </div>
                                            </div>
                                            <div class="features mt-3">
                                                <p><span>Property size</span><span><%= listing.propertyInfo.area %>
                                                        ft²</span></p>
                                                <p><span>Bedrooms</span><span><%= listing.propertyInfo.bedrooms %></span>
                                                </p>
                                                <p><span>Bathrooms</span><span><%= listing.propertyInfo.bathrooms %></span>
                                                </p>
                                                <p><span>Garages</span><span><%= listing.propertyInfo.reservedParking %></span>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="grow"></div>
                                        <div class="actions row between-xs middle-xs">
                                            <p class="row date mb-0">
                                                <i class="material-icons text-muted">date_range</i>
                                                <span class="mx-2"><%= moment(listing.createdAt).format("ll") %></span>
                                            </p>
                                            <a href="/listing/<%= hyphenateString(listing.listingInfo.title) + "-"+ listing._id %>"
                                                class="mdc-button mdc-button--outlined">
                                                <span class="mdc-button__ripple"></span>
                                                <span class="mdc-button__label">Details</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <% }); %>
                        </div>
                    </div>
                    <% } %>
                </aside>
                <div class="mdc-drawer-scrim page-sidenav-scrim"></div>
            </div>
        </div>
    </div>
    <div class="section mt-3">
        <div class="px-3">
            <div class="theme-container">
                <h1 class="section-title">Featured properties</h1>
                <div class="properties-carousel">
                    <div class="swiper-container carousel-outer">
                        <div class="swiper-wrapper">
                            <% featuredListings.forEach((listing) => { %>
                            <div class="swiper-slide">
                                <div class="mdc-card property-item grid-item column-4 full-width-page">
                                    <div class="thumbnail-section">
                                        <div class="row property-status">
                                            <% for(let i = 0; i < listing.listingInfo.tags.length; i++) {
                                        let tag = listing.listingInfo.tags[i]; 
                                        let color = tag === "FOR SALE" ? "green" :
                                                    tag === "FEATURED" ? "orange" :
                                                    tag === "FOR RENT" ? "blue" :
                                                    tag === "HOT OFFER" ? "red" :
                                                    tag === "SOLD" ? "dark" :
                                                    tag === "NEW" ? "teal" : ""
                                        %>
                                            <span class="<%= color %>"><%= tag %></span>
                                            <% } %>
                                        </div>
                                        <div class="property-image">
                                            <div class="swiper-container">
                                                <div class="swiper-wrapper">
                                                    <% listing.media.images.forEach((image) => { %>
                                                    <div class="swiper-slide">
                                                        <img src="/assets/images/others/transparent-bg.png"
                                                            alt="slide image <%= image %>"
                                                            data-src="/uploads/listing/<%= listing._id %>/images/medium/<%= image %>"
                                                            class="slide-item swiper-lazy">
                                                        <div class="swiper-lazy-preloader"></div>
                                                    </div>
                                                    <% }); %>
                                                </div>
                                                <div class="swiper-pagination white"></div>
                                                <button class="mdc-icon-button swiper-button-prev swipe-arrow"><i
                                                        class="material-icons mat-icon-lg">keyboard_arrow_left</i></button>
                                                <button class="mdc-icon-button swiper-button-next swipe-arrow"><i
                                                        class="material-icons mat-icon-lg">keyboard_arrow_right</i></button>
                                            </div>
                                        </div>
                                        <div class="control-icons">
                                            <button class="mdc-button add-to-favorite" data-value="<%= listing._id %>"
                                                title="Add To Favorite">
                                                <i class="material-icons mat-icon-sm">favorite_border</i>
                                            </button>
                                            <button class="mdc-button add-to-compare" data-value="<%= listing._id %>"
                                                title="Add To Compare">
                                                <i class="material-icons mat-icon-sm">compare_arrows</i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="property-content-wrapper">
                                        <div class="property-content">
                                            <div class="content">
                                                <h1 class="title">
                                                    <a
                                                        href="/listing/<%= hyphenateString(listing.listingInfo.title) + "-"+ listing._id %>">
                                                        <%= listing.listingInfo.title %>
                                                    </a>
                                                </h1>
                                                <p class="row address flex-nowrap">
                                                    <i class="material-icons text-muted">location_on</i>
                                                    <span><%= listing.location.sector + ", " + listing.location.city %></span>
                                                </p>
                                                <div class="row between-xs middle-xs">
                                                    <h3 class="primary-color price">
                                                        <span><%= new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0,  maximumFractionDigits: 0 }).format(listing.price) %></span>
                                                    </h3>
                                                    <div class="row start-xs middle-xs ratings" title="29">
                                                        <i class="material-icons mat-icon-sm">star</i>
                                                        <i class="material-icons mat-icon-sm">star</i>
                                                        <i class="material-icons mat-icon-sm">star</i>
                                                        <i class="material-icons mat-icon-sm">star</i>
                                                        <i class="material-icons mat-icon-sm">star</i>
                                                    </div>
                                                </div>
                                                <div class="d-none d-md-flex d-lg-flex d-xl-flex">
                                                    <div class="description mt-3">
                                                        <p><%= listing.listingInfo.description %></p>
                                                    </div>
                                                </div>
                                                <div class="features mt-3">
                                                    <p><span>Property size</span><span><%= listing.propertyInfo.area %>
                                                            ft²</span></p>
                                                    <p><span>Bedrooms</span><span><%= listing.propertyInfo.bedrooms %></span>
                                                    </p>
                                                    <p><span>Bathrooms</span><span><%= listing.propertyInfo.bathrooms %></span>
                                                    </p>
                                                    <p><span>Garages</span><span><%= listing.propertyInfo.reservedParking %></span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="grow"></div>
                                            <div class="actions row between-xs middle-xs">
                                                <p class="row date mb-0">
                                                    <i class="material-icons text-muted">date_range</i>
                                                    <span
                                                        class="mx-2"><%= moment(listing.createdAt).format("ll") %></span>
                                                </p>
                                                <a href="/listing/<%= hyphenateString(listing.listingInfo.title) + "-"+ listing._id %>"
                                                    class="mdc-button mdc-button--outlined">
                                                    <span class="mdc-button__ripple"></span>
                                                    <span class="mdc-button__label">Details</span>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <% }); %>
                        </div>
                        <button class="prop-prev swiper-button-prev swipe-arrow mdc-fab mdc-fab--mini primary">
                            <span class="mdc-fab__ripple"></span>
                            <span class="mdc-fab__icon material-icons">keyboard_arrow_left</span>
                        </button>
                        <button class="prop-next swiper-button-next swipe-arrow mdc-fab mdc-fab--mini primary">
                            <span class="mdc-fab__ripple"></span>
                            <span class="mdc-fab__icon material-icons">keyboard_arrow_right</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="px-3">
        <div class="theme-container">
            <div class="get-in-touch bg-primary">
                <img src="/assets/images/others/operator.png" alt="operator"
                    class="d-none d-sm-flex d-md-flex d-lg-flex d-xl-flex">
                <div class="row between-xs middle-xs content">
                    <div class="column p-3">
                        <h2>LOOKING TO SELL YOUR HOME?</h2>
                        <p class="mb-0">Lorem ipsum dolor sit, amet consectetur adipisicing elit.</p>
                    </div>
                    <div class="row start-xs middle-xs p-3">
                        <i class="material-icons mat-icon-xlg mx-2">call</i>
                        <div class="column">
                            <p class="mb-0">CALL US NOW</p>
                            <h2 class="ws-nowrap">(+100) 123 456 7890</h2>
                        </div>
                    </div>
                    <div class="p-3">
                        <a href="javascript:void(0);" class="mdc-button mdc-button--raised mx-3">
                            <span class="mdc-button__ripple"></span>
                            <span class="mdc-button__label">get in touch</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<%- include ("../partials/footer") %>